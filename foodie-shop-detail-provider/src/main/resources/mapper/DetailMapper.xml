<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.lanke.foodie.dao.DetailDao">

    <insert id="addShop">
        insert
        into
        shop
        (
        username,
        password,
        shop_name,
        shop_address,
        shop_email,
        shop_phone,
        shop_status,
        pay_detail_id,
        create_time
        )
        values
        (
        #{username},
        #{password},
        #{shop_name},
        #{shop_address},
        #{shop_email},
        #{shop_phone},
        #{shop_status},
        #{id},
        #{create_time}
        )
    </insert>
    <insert id="addPay" useGeneratedKeys="true" keyProperty="id">
        insert
        into
        pay_detail
        (
        mch_id,
        api_key,
        create_time
        )
        values
        (
        #{mch_id},
        #{api_key},
        #{create_time}
        )

    </insert>
    <select id="checkUsername" resultType="int">
        select
        count(*)
        from
        shop
        where
        username = #{username}
    </select>
    <select id="checkShopName" resultType="int">
        select
        count(*)
        from
        shop
        where
        shop_name = #{shop_name}
    </select>
    <update id="updateShop">
        update
        shop
        set
        shopName = #{shop_name},
        shopAddress = #{shop_address},
        shopEmail = #{shop_email},
        shopPhone = #{shop_phone}
        where
        id = {id}
    </update>
    <update id="updatePay">
        update
        pay_detail
        set
        mch_id = #{mch_id},
        api_key = #{api_key}
        where
        id = #{payDetailId}
    </update>
    <select id="getShopById" resultType="Shop">
        select
        *
        from
        shop
        where
        id = #{id}
    </select>
    <select id="getShopDetailById" resultType="com.lanke.foodie.entity.PayDetail">
        select
        *
        from
        pay_detail
        where
        id = #{id}
    </select>


</mapper>